<!DOCTYPE HTML>
<html>
<head>
  <title>{{ title }}</title>
  {{#each cssUrls}}
    <link rel="stylesheet" href="{{ this }}">{{/each}}
  {{{ meta }}}
  {{#if currentUrlAfterRedirect }}
    <script>
      try {
        if (window.history) {
          history.replaceState({}, {{json title}}, {{json currentUrlAfterRedirect}});
        }
      } catch (e) {}
    </script>
  {{/if}}
</head>
<body><div id="skit-controller">{{{ body }}}</div>
  <script>
    window.skit = {
      objects: {}
    };
  </script>{{#each scriptUrls}}
  <script src="{{ this }}"></script>{{/each}}
  <script>
    (function() {
      {{#if clientProxyObjects}}
        var netproxy = window.skit.objects[{{json netproxyModulePath}}];
        {{#each clientProxyObjects}}
          netproxy.__register__({{json name}}, {{json this}});
        {{/each}}
      {{/if}}

      var ControllerKlass = window.skit.objects[{{json controllerModulePath }}];
      var controller = new ControllerKlass({{json params }});

      var controllerProperties = {{json controllerProperties }};
      for (var k in controllerProperties) {
        controller[k] = controllerProperties[k];
      }

      controller.recursiveLoad();
      controller.recursiveReady();
    })();
  </script>
</body>